[
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Delivery Note",
  "enabled": 1,
  "modified": "2024-09-17 15:49:09.610100",
  "module": "Barcode Generator",
  "name": "Barcode Scanner - DN",
  "script": "frappe.ui.form.on('Delivery Note', {\n    \n        refresh: function(frm) {\n\n        function addScannerIconToField(field) {\n            if (!field.$scanner_icon_appended) {\n                field.$scanner_icon_appended = true;\n\n\n                // var $scannerIcon = $('<span class=\"scanner-icon\" style=\"cursor: pointer; position: absolute; right: 5px; top: 50%; transform: translateY(-50%); font-size: 15px; width: 18px; height: 18px; line-height: 18px; text-align: center; border-radius: 50%; background-color: var(--disabled-text-color); color: #1C2126;\">&#128247;</span>')\n                var $icon = $('<span class=\"link-btn\" style=\"display: inline;\"><a class=\"btn-open no-decoration\" title=\"Scan\"><svg class=\"icon  icon-sm\" style=\"\" aria-hidden=\"true\"><use class=\"\" href=\"#icon-scan\"></use></svg></a></span>');\n                field.$input.parent().css('position', 'relative'); \n                field.$input.css('position', 'relative'); \n                field.$input.after($icon);\n\n\n                $icon.on('click', function() {\n                    // frm.set_value(field.df.fieldname, '');\n                    \n                    const scanner = new frappe.ui.Scanner({\n                          dialog: true, // open camera scanner in a dialog\n                          multiple: false, // stop after scanning one value\n                          on_scan(data) {\n                                            frappe.call({\n                            method: \"barcode_generator.barcode_generator.doctype.master_barcode_generator.master_barcode_generator.get_items\",\n                            args: {\n                                'qr_number': data.decodedText,\n                            },\n                            callback: function (r) {\n                                var data = r.message;\n                                console.log(data);\n                                if (data.length == 2) {\n                                    frm.set_value(\"items\", 0)\n                                    var child_create1 = frm.add_child(\"items\");\n                                    child_create1.item_code = data[0][0].item_code\n                                    \n                                    child_create1.use_serial_batch_fields = 1\n                                    child_create1.serial_no = data[0][0].serial_no;\n                                    child_create1.qty = 1;\n                                    child_create1.item_name = data[0][0]['item_name'];\n                                    child_create1.uom = data[1][0]['stock_uom'];\n                                    \n                                } else {\n                                    frm.set_value(\"items\", 0)\n                                    var child_create = frm.add_child(\"items\");\n                                    child_create.item_code = data[1][0].item_code\n                                    \n                                    child_create.use_serial_batch_fields = 1\n                                    var serial_no = \"\"\n                                        data[0].forEach(function (obj) {\n                                            serial_no += obj['serial_no']\n                                            serial_no += \"\\n\"\n                                        })\n                                    child_create.serial_no = serial_no;\n                                    child_create.qty = data[0].length;\n                                    child_create.item_name = data[0][0]['item_name'];\n                                    child_create.uom = data[2][0]['stock_uom'];\n                                }\n                \n                            },\n                        });\n                            \n                            console.log(data.decodedText);\n                            }\n                        });\n                });\n            }\n        }\n\n\n        $.each(frm.fields_dict, function(fieldname, field) {\n            if (fieldname === 'custom_barcode_scanner') {\n                addScannerIconToField(field);\n            }\n        });\n        }\n});\n\nfrappe.ui.form.on('Delivery Note', {\n    \n\tcustom_barcode_scanner(frm) {\n\t\t// your code here\n    \tfrappe.call({\n            method: \"barcode_generator.barcode_generator.doctype.master_barcode_generator.master_barcode_generator.get_items\",\n            args: {\n                'qr_number': frm.doc.custom_barcode_scanner,\n            },\n            callback: function (r) {\n                var data = r.message;\n                console.log(data);\n                if (data.length == 2) {\n                    frm.set_value(\"items\", 0)\n                    var child_create1 = frm.add_child(\"items\");\n                    child_create1.item_code = data[0][0].item_code\n                    \n                    child_create1.use_serial_batch_fields = 1\n                    child_create1.serial_no = data[0][0].serial_no;\n                    child_create1.qty = 1;\n                    child_create1.item_name = data[0][0]['item_name'];\n                    child_create1.uom = data[1][0]['stock_uom'];\n                    \n                } else {\n                    frm.set_value(\"items\", 0)\n                    var child_create = frm.add_child(\"items\");\n                    child_create.item_code = data[1][0].item_code\n                    \n                    child_create.use_serial_batch_fields = 1\n                    var serial_no = \"\"\n                        data[0].forEach(function (obj) {\n                            serial_no += obj['serial_no']\n                            serial_no += \"\\n\"\n                        })\n                    child_create.serial_no = serial_no;\n                    child_create.qty = data[0].length;\n                    child_create.item_name = data[0][0]['item_name'];\n                    child_create.uom = data[2][0]['stock_uom'];\n                }\n\n            },\n        });\n\n\t}\n});",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Sales Invoice",
  "enabled": 1,
  "modified": "2024-09-17 15:49:20.690041",
  "module": "Barcode Generator",
  "name": "Barcode Scanner - Sales Invoice",
  "script": "frappe.ui.form.on('Sales Invoice', {\n    \n        refresh: function(frm) {\n\n        function addScannerIconToField(field) {\n            if (!field.$scanner_icon_appended) {\n                field.$scanner_icon_appended = true;\n\n\n                // var $scannerIcon = $('<span class=\"scanner-icon\" style=\"cursor: pointer; position: absolute; right: 5px; top: 50%; transform: translateY(-50%); font-size: 15px; width: 18px; height: 18px; line-height: 18px; text-align: center; border-radius: 50%; background-color: var(--disabled-text-color); color: #1C2126;\">&#128247;</span>')\n                var $icon = $('<span class=\"link-btn\" style=\"display: inline;\"><a class=\"btn-open no-decoration\" title=\"Scan\"><svg class=\"icon  icon-sm\" style=\"\" aria-hidden=\"true\"><use class=\"\" href=\"#icon-scan\"></use></svg></a></span>');\n                field.$input.parent().css('position', 'relative'); \n                field.$input.css('position', 'relative'); \n                field.$input.after($icon);\n\n\n                $icon.on('click', function() {\n                    // frm.set_value(field.df.fieldname, '');\n                    \n                    const scanner = new frappe.ui.Scanner({\n                          dialog: true, // open camera scanner in a dialog\n                          multiple: false, // stop after scanning one value\n                          on_scan(data) {\n                                            frappe.call({\n                            method: \"barcode_generator.barcode_generator.doctype.master_barcode_generator.master_barcode_generator.get_items\",\n                            args: {\n                                'qr_number': data.decodedText,\n                            },\n                            callback: function (r) {\n                                var data = r.message;\n                                console.log(data);\n                                if (data.length == 2) {\n                                    frm.set_value(\"items\", 0)\n                                    var child_create1 = frm.add_child(\"items\");\n                                    child_create1.item_code = data[0][0].item_code\n                                    \n                                    child_create1.use_serial_batch_fields = 1\n                                    child_create1.serial_no = data[0][0].serial_no;\n                                    child_create1.qty = 1;\n                                    child_create1.item_name = data[0][0]['item_name'];\n                                    child_create1.uom = data[1][0]['stock_uom'];\n                                    \n                                } else {\n                                    frm.set_value(\"items\", 0)\n                                    var child_create = frm.add_child(\"items\");\n                                    child_create.item_code = data[1][0].item_code\n                                    \n                                    child_create.use_serial_batch_fields = 1\n                                    var serial_no = \"\"\n                                        data[0].forEach(function (obj) {\n                                            serial_no += obj['serial_no']\n                                            serial_no += \"\\n\"\n                                        })\n                                    child_create.serial_no = serial_no;\n                                    child_create.qty = data[0].length;\n                                    child_create.item_name = data[0][0]['item_name'];\n                                    child_create.uom = data[2][0]['stock_uom'];\n                                }\n                \n                            },\n                        });\n                            \n                            console.log(data.decodedText);\n                            }\n                        });\n                });\n            }\n        }\n\n\n        $.each(frm.fields_dict, function(fieldname, field) {\n            if (fieldname === 'custom_barcode_scanner') {\n                addScannerIconToField(field);\n            }\n        });\n        }\n});\n\nfrappe.ui.form.on('Sales Invoice', {\n    \n\tcustom_barcode_scanner(frm) {\n\t\t// your code here\n    \tfrappe.call({\n            method: \"barcode_generator.barcode_generator.doctype.master_barcode_generator.master_barcode_generator.get_items\",\n            args: {\n                'qr_number': frm.doc.custom_barcode_scanner,\n            },\n            callback: function (r) {\n                var data = r.message;\n                console.log(data);\n                if (data.length == 2) {\n                    frm.set_value(\"items\", 0)\n                    var child_create1 = frm.add_child(\"items\");\n                    child_create1.item_code = data[0][0].item_code\n                    \n                    child_create1.use_serial_batch_fields = 1\n                    child_create1.serial_no = data[0][0].serial_no;\n                    child_create1.qty = 1;\n                    child_create1.item_name = data[0][0]['item_name'];\n                    child_create1.uom = data[1][0]['stock_uom'];\n                    \n                } else {\n                    frm.set_value(\"items\", 0)\n                    var child_create = frm.add_child(\"items\");\n                    child_create.item_code = data[1][0].item_code\n                    \n                    child_create.use_serial_batch_fields = 1\n                    var serial_no = \"\"\n                        data[0].forEach(function (obj) {\n                            serial_no += obj['serial_no']\n                            serial_no += \"\\n\"\n                        })\n                    child_create.serial_no = serial_no;\n                    child_create.qty = data[0].length;\n                    child_create.item_name = data[0][0]['item_name'];\n                    child_create.uom = data[2][0]['stock_uom'];\n                }\n\n            },\n        });\n\n\t}\n});",
  "view": "Form"
 }
]